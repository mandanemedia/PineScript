//@version=2
//@author DanialJ
strategy(title="BTC longs vs Short ", shorttitle="BTC Long/Short")

// Inputs from user
source=input(ohlc4, title="Input Source" )
deduction=input(7000, title="Always Long", type=integer,  step=500)
MALenght=input(13, title="MA Length", type=integer)

// Security
Longs = security("BITFINEX:BTCUSDLONGS", period, source, false) - deduction
Shorts = security("BITFINEX:BTCUSDSHORTS", period, source, false)



pLongs = Longs[1]
pShorts = Shorts[1]
diffLongs= (Longs-pLongs)/ pLongs
diffShorts= (Shorts-pShorts)/ pShorts 
   
ratioChange = (pLongs - pShorts) / (pShorts+pLongs)
average = ema(ratioChange, MALenght) 

color = ratioChange>average ? blue : red
plot(ratioChange, style=line,  linewidth=2, color=color)
bgcolor(color, transp=85 )
plot(average, style=line,  linewidth=1, color=black)


if ( ratioChange> average)
    strategy.entry("Long", strategy.long)

if (ratioChange< average)
    strategy.entry("Short", strategy.short)
